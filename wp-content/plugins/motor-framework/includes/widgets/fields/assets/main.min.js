"use strict";var widget_acf={acf_init:function(){jQuery("h3.title",".widget_acf_accordion").off(),jQuery("h3.title",".widget_acf_accordion").click(function(){var a=jQuery(this).parent(),b=jQuery(".fieldset",a),c=b.attr("data-collapse");"undefined"==typeof c||"1"==c?(b.slideDown(),b.attr("data-collapse","0"),jQuery("span",jQuery(this)).removeClass("collapse-in"),jQuery("span",jQuery(this)).addClass("collapse-out")):(b.slideUp(),b.attr("data-collapse","1"),jQuery("span",jQuery(this)).removeClass("collapse-out"),jQuery("span",jQuery(this)).addClass("collapse-in"))}),jQuery('input[data-title="1"]',".widget_acf_accordion").keyup(function(){var a=jQuery(this).val(),b=jQuery(this).attr("data-section-id");""==a&&(a="New Section"),jQuery("span:last-child","#"+b+" h3.title").text(a)}),jQuery('input[data-title="1"]',".widget_acf_accordion").off(),jQuery('input[data-title="1"]',".widget_acf_accordion").keyup(function(){var a=jQuery(this).val(),b=jQuery(this).attr("data-section-id");""==a&&(a="New Section"),jQuery("span:last-child","#"+b+" h3.title").text(a)}),jQuery(".button.add",".widget_acf_wrap").off(),jQuery(".button.add",".widget_acf_wrap").click(function(){widget_acf.addSection(jQuery(this))}),jQuery(".button.deletion",".widget_acf_wrap").off(),jQuery(".button.deletion",".widget_acf_wrap").click(function(){widget_acf.delSection(jQuery(this))});var a=jQuery(".widget_acf_wrap");widget_acf.initSelect2(a),widget_acf.uploadImage(),widget_acf.initCheckbox(a),widget_acf.registerRequireElement(a),jQuery("input, select",a).each(function(){widget_acf.initRequireElement(jQuery(this))}),jQuery.isFunction(jQuery.fn.sortable)&&jQuery(".accordion-wrap").sortable({update:function(){widget_acf.reIndexSection(jQuery(".widget_acf_wrap"))}})},addSection:function(a){var b=jQuery(a).parent().parent(),c=jQuery(".widget_acf_accordion",b).last().clone(!0);jQuery("input",jQuery(c)).each(function(){jQuery(this).val("")}),jQuery(".media img",c).remove(),jQuery(".media .remove-media",c).remove(),jQuery("h3.title span",c).last().html("New Section"),jQuery(".fieldset",c).attr("data-collapse",0),jQuery(".fieldset",c).show(),jQuery("input",c).first().focus(),jQuery(".widget_acf_accordion",b).last().after(c),widget_acf.reIndexSection(a);var d=jQuery(".widget_acf_accordion",b).last();jQuery("div.select-wrap",d).each(function(){var a=jQuery("label",jQuery(this)).clone(!1),b=jQuery("select",jQuery(this)).clone(!1),c=jQuery('input[type="hidden"]',jQuery(this)).clone(!1);b.removeClass("select2-offscreen"),jQuery(this).empty(),"undefined"!=typeof a&&jQuery(this).append(a),"undefined"!=typeof c&&jQuery(this).append(c),"undefined"!=typeof b&&jQuery(this).append(b)}),widget_acf.initSelect2(d),widget_acf.initCheckbox(d),widget_acf.registerRequireElement(d)},delSection:function(a){var b=jQuery(a).parent().parent().parent().parent(),c=jQuery(".widget_acf_accordion",jQuery(b)).length,d=jQuery(a).parent().parent().parent();c>1?(jQuery(d).remove(),widget_acf.reIndexSection(a)):(jQuery("input",jQuery(b)).each(function(){jQuery(this).val("")}),jQuery("h3.title span",jQuery(b)).last().html("New Section"))},uploadImage:function(){jQuery(".widget-acf-upload-button").each(function(){jQuery(this).off(),jQuery(this).click(function(a){if(a.preventDefault(),wp.media.frames.gk_frame)return wp.media.frames.gk_frame.open(),void(wp.media.frames.gk_frame.clicked_button=jQuery(this));wp.media.frames.gk_frame=wp.media({title:"Select image",multiple:!1,library:{type:"image"},button:{text:"Use selected image"}}),wp.media.frames.gk_frame.clicked_button=jQuery(this);var b=function(){var a=wp.media.frames.gk_frame.state().get("selection");a&&a.each(function(a){var b=a.attributes.url,c=jQuery(wp.media.frames.gk_frame.clicked_button).parent(),d=jQuery("img",c),e=jQuery("a.remove-media",c),f=jQuery('input[data-type="id"]',c),g=jQuery('input[data-type="url"]',c),h=wp.media.frames.gk_frame.clicked_button.attr("data-width"),i=wp.media.frames.gk_frame.clicked_button.attr("data-height");"undefined"==typeof h&&(h=46),"undefined"==typeof i&&(i=28),d.length<=0&&(d='<img src="" width="'+h+'" height="'+i+'">',d=jQuery(d)),d.attr("src",b),g.val(b),f.val(a.attributes.id),c.prepend(d),e.length<=0&&(e=jQuery('<a href="javascript:void(0);" class="button remove-media">Remove</a>'),e.insertAfter(wp.media.frames.gk_frame.clicked_button)),widget_acf.removeImage(c)})};wp.media.frames.gk_frame.on("select",b),wp.media.frames.gk_frame.open()}),widget_acf.removeImage(jQuery(this).parent())})},removeImage:function(a){jQuery(".remove-media",a).off(),jQuery(".remove-media",a).click(function(){var b=jQuery('input[data-type="id"]',a),c=jQuery('input[data-type="url"]',a),d=jQuery("img",a);d.remove(),c.val(""),b.val(""),jQuery(this).remove()})},initSelect2:function(a){jQuery.isFunction(jQuery.fn.select2)&&jQuery("select.select2",a).each(function(){var a="#s2id_"+jQuery(this).attr("id"),b=jQuery(a,jQuery(this).parent());"undefined"!=typeof b&&b.remove(),jQuery(this).select2({allowClear:!0});var c=jQuery(this).attr("data-multiple");if("undefined"!=typeof c&&"1"==c){var d=jQuery("input",jQuery(this).parent()).first(),e=jQuery(d).val(),f=[];if("undefined"!=typeof e&&""!=e){e=e.split(",");for(var g=0;g<e.length;g++){var h=jQuery("option[value="+e[g]+"]",jQuery(this));f[g]={id:e[g],text:h[0].label,element:h}}jQuery(this).select2("data",f)}jQuery(this).on("select2-selecting",function(a){var b=jQuery(this).val();("undefined"==typeof b||null==b)&&(b=""),""!=b&&(b+=","),b+=a.val,jQuery(d).val(b)}).on("select2-removed",function(a){for(var b=jQuery(d).val(),c=b.split(","),e="",f=0;f<c.length;f++)c[f]!=a.val&&(""!=e&&(e+=","),e+=c[f]);jQuery(d).val(e)})}var i=jQuery(this).attr("data-select-icon");"undefined"!=typeof i&&"1"==i&&(console.log(i),jQuery(this).select2({formatResult:widget_acf.formatIconState,formatSelection:widget_acf.formatIconState}))})},initCheckbox:function(a){jQuery(".checkbox",a).each(function(){var a=jQuery(this);a.off(),a.change(function(){a.val(a.is(":checked")?"1":"0")})})},reIndexSection:function(a){var b=".widget_acf_wrap",c=".widget_acf_accordion",d="widget_acf_accordion_";jQuery(c,b).each(function(a){a--,jQuery(this).attr("id",d+a),jQuery("input",jQuery(this)).each(function(){"undefined"!=typeof jQuery(this).attr("name")&&jQuery(this).attr("name",jQuery(this).attr("name").replace(/\[(\d+)\](?!.*\[\d+\])/,"["+a+"]")),jQuery(this).attr("id",jQuery(this).attr("id").replace(/[0-9]$/,a)),jQuery(this).attr("data-section-id",d+a)}),jQuery("div[data-require-element-id]",jQuery(this)).each(function(){jQuery(this).attr("data-require-element-id",jQuery(this).attr("data-require-element-id").replace(/[0-9]$/,a))}),jQuery("select",jQuery(this)).each(function(){"undefined"!=typeof jQuery(this).attr("name")&&jQuery(this).attr("name",jQuery(this).attr("name").replace(/\[(\d+)\](?!.*\[\d+\])/,"["+a+"]")),jQuery(this).attr("id",jQuery(this).attr("id").replace(/[0-9]$/,a))}),jQuery("a.button.deletion").each(function(){jQuery(this).attr("data-section-id",d+a)})})},registerRequireElement:function(a){jQuery("input, select",a).change(function(){widget_acf.initRequireElement(jQuery(this))})},initRequireElement:function(a){var b=a.attr("id"),c=a.val();jQuery('div[data-require-element-id="'+b+'"]').each(function(){var a=jQuery(this).attr("data-require-compare"),b=jQuery(this).attr("data-require-values");"undefined"!=typeof b&&""!=b&&(b=b.split(","));var d=!1;"!="==a&&(d=!0),jQuery.each(b,function(b,e){return e==c?void(d="="==a):void 0}),d?jQuery(this).show():jQuery(this).hide()})},formatIconState:function(a){if(!a.id)return a.text;var b=jQuery('<span><i class="'+a.element[0].value.toLowerCase()+'"/> '+a.text+"</span>");return b}};